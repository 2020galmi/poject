#!/bin/bash
# simple tshark bash script 


echo "

     ___           ___           ___           ___           ___           ___           ___           ___                       ___           ___     
     /  /\         /__/\         /  /\         /  /\         /__/|         /__/\         /__/\         /__/\          ___        /  /\         /  /\    
    /  /:/_        \  \:\       /  /::\       /  /::\       |  |:|         \  \:\        \  \:\        \  \:\        /  /\      /  /:/_       /  /::\   
   /  /:/ /\        \__\:\     /  /:/\:\     /  /:/\:\      |  |:|          \__\:\        \  \:\        \  \:\      /  /:/     /  /:/ /\     /  /:/\:\  
  /  /:/ /::\   ___ /  /::\   /  /:/~/::\   /  /:/~/:/    __|  |:|      ___ /  /::\   ___  \  \:\   _____\__\:\    /  /:/     /  /:/ /:/_   /  /:/~/:/  
 /__/:/ /:/\:\ /__/\  /:/\:\ /__/:/ /:/\:\ /__/:/ /:/___ /__/\_|:|____ /__/\  /:/\:\ /__/\  \__\:\ /__/::::::::\  /  /::\    /__/:/ /:/ /\ /__/:/ /:/___
 \  \:\/:/~/:/ \  \:\/:/__\/ \  \:\/:/__\/ \  \:\/:::::/ \  \:\/:::::/ \  \:\/:/__\/ \  \:\ /  /:/ \  \:\~~\~~\/ /__/:/\:\   \  \:\/:/ /:/ \  \:\/:::::/
  \  \::/ /:/   \  \::/       \  \::/       \  \::/~~~~   \  \::/~~~~   \  \::/       \  \:\  /:/   \  \:\  ~~~  \__\/  \:\   \  \::/ /:/   \  \::/~~~~ 
   \__\/ /:/     \  \:\        \  \:\        \  \:\        \  \:\        \  \:\        \  \:\/:/     \  \:\           \  \:\   \  \:\/:/     \  \:\     
     /__/:/       \  \:\        \  \:\        \  \:\        \  \:\        \  \:\        \  \::/       \  \:\           \__\/    \  \::/       \  \:\    
     \__\/         \__\/         \__\/         \__\/         \__\/         \__\/         \__\/         \__\/                     \__\/         \__\/    


░  ░  ░░░ ░  ░  ░░ ░ ░░░ ░ ░    ░   ░ ░   ░         ░     ░░   ░      ░   ░  ░  ░      ░  ░   ░     ░  ░    ░
 " 


echo " ###################created by ohtmane elghalmi #########################"

#nmap scan detection

TCP_SYN_scan="tcp.flags.syn==1 and tcp.flags.ack==0 and tcp.window_size >= 1024 and tcp.window_size < 50000"
TCP_Connect_scan="tcp.flags.syn==1 and tcp.flags.ack==0 and  tcp.window_size < 60000"
TCP_Null_scan="tcp.flags==0"
TCP_FIN_scan="tcp.flags==0x001"
TCP_Xmass_scan="tcp.flags.fin==1 && tcp.flags.push==1 && tcp.flags.urg==1"
UDP_port_scan="icmp.type==3 and icmp.code==3"


#Detection of network attacks

ARP_poisoning="arp.duplicate-address-detected or arp.duplicate-address-frame"
ICMP_flood="icmp and data.len > 48"
VLAN_hoping="dtp or vlan.too_many_tags"
Unexplained_packet_loss="tcp.analysis.lost_segment or tcp.analysis.retransmission"
Suspicious_User_Agents="http.user_agent contains curl"
unusual_packet_sizes="frame.len < 64 or frame.len > 1500"
Possible_ARP_Spoofing="arp.src.hw_mac != eth.src"

echo "simple pcap filtring tool
1-TCP_SYN_scan
2-TCP_Connect_scan
3-TCP_Null_scan
4-TCP_FIN_scan
5-TCP_Xmass_scan
6-UDP_port_scan
7-ARP_poisoning
8-ICMP_flood
9-VLAN_hoping
10-Unexplained_packet_loss
11-Suspicious_User_Agents
12-unusual_packet_sizes
13-Possible_ARP_Spoofing

choose what are you want to filter for:

"

read choice 


if [ $choice -eq 1 ]; then
  
  tshark -r $1 -Y """ $TCP_SYN_scan """
fi

if [ $choice -eq 2 ]; then
  
  tshark -r $1 -Y """$TCP_Connect_scan"""
fi

if [ $choice -eq 3 ]; then
  
  tshark -r $1 -Y """$TCP_Null_scan"""
fi

if [ $choice -eq 4 ]; then
  
  tshark -r $1 -Y """$TCP_FIN_scan"""
fi

if [ $choice -eq 5 ]; then
   
  tshark -r $1 -Y """$TCP_Xmass_scan"""
fi

if [ $choice -eq 6 ]; then
 
  tshark -r $1 -Y """$UDP_port_scan"""
fi

if [ $choice -eq 7 ]; then
  
  tshark -r $1 -Y """$ARP_poisoning"""
fi

if [ $choice -eq 8 ]; then
  
  tshark -r $1 -Y """$ICMP_flood"""
fi

if [ $choice -eq 9 ]; then
  
  tshark -r $1 -Y """$VLAN_hoping"""
fi

if [ $choice -eq 10 ]; then
  
  tshark -r $1 -Y """$Unexplained_packet_loss"""
fi

if [ $choice -eq 11 ]; then
  
  tshark -r $1 -Y """$Suspicious_User_Agents"""
fi

if [ $choice -eq 12 ]; then
  
  tshark -r $1 -Y """$unusual_packet_sizes"""
fi


if [ $choice -eq 13 ]; then
  
  tshark -r $1 -Y """$Possible_ARP_Spoofing"""
fi

echo "
===========================================================================================================================
==      ===  ====  =====  =====       ===  ====  ============  ====  ==  ====  ==  =======  ==        ==        ==       ==
=  ====  ==  ====  ====    ====  ====  ==  ===  =============  ====  ==  ====  ==   ======  =====  =====  ========  ====  =
=  ====  ==  ====  ===  ==  ===  ====  ==  ==  ==============  ====  ==  ====  ==    =====  =====  =====  ========  ====  =
==  =======  ====  ==  ====  ==  ===   ==  =  ===============  ====  ==  ====  ==  ==  ===  =====  =====  ========  ===   =
====  =====        ==  ====  ==      ====     =====        ==        ==  ====  ==  ===  ==  =====  =====      ====      ===
======  ===  ====  ==        ==  ====  ==  ==  ==============  ====  ==  ====  ==  ====  =  =====  =====  ========  ====  =
=  ====  ==  ====  ==  ====  ==  ====  ==  ===  =============  ====  ==  ====  ==  =====    =====  =====  ========  ====  =
=  ====  ==  ====  ==  ====  ==  ====  ==  ====  ============  ====  ==   ==   ==  ======   =====  =====  ========  ====  =
==      ===  ====  ==  ====  ==  ====  ==  ====  ============  ====  ===      ===  =======  =====  =====        ==  ====  =
===========================================================================================================================


      ___           ___           ___     
     /\  \         /\__\         /\  \    
    /::\  \       /::|  |       /::\  \   
   /:/\:\  \     /:|:|  |      /:/\:\  \  
  /::\~\:\  \   /:/|:|  |__   /:/  \:\__\ 
 /:/\:\ \:\__\ /:/ |:| /\__\ /:/__/ \:|__|
 \:\~\:\ \/__/ \/__|:|/:/  / \:\  \ /:/  /
  \:\ \:\__\       |:/:/  /   \:\  /:/  / 
   \:\ \/__/       |::/  /     \:\/:/  /  
    \:\__\         /:/  /       \::/__/   
     \/__/         \/__/         ~~       




        _            _       _    _                   _           _                    _       _    _                  _           _            _            _      
       / /\         / /\    / /\ / /\                /\ \        /\_\                 / /\    / /\ /\_\               /\ \     _  /\ \         /\ \         /\ \    
      / /  \       / / /   / / // /  \              /  \ \      / / /  _             / / /   / / // / /         _    /  \ \   /\_\\_\ \       /  \ \       /  \ \   
     / / /\ \__   / /_/   / / // / /\ \            / /\ \ \    / / /  /\_\          / /_/   / / / \ \ \__      /\_\ / /\ \ \_/ / //\__ \     / /\ \ \     / /\ \ \  
    / / /\ \___\ / /\ \__/ / // / /\ \ \          / / /\ \_\  / / /__/ / / ____    / /\ \__/ / /   \ \___\    / / // / /\ \___/ // /_ \ \   / / /\ \_\   / / /\ \_\ 
    \ \ \ \/___// /\ \___\/ // / /  \ \ \        / / /_/ / / / /\_____/ //\____/\ / /\ \___\/ /     \__  /   / / // / /  \/____// / /\ \ \ / /_/_ \/_/  / / /_/ / / 
     \ \ \     / / /\/___/ // / /___/ /\ \      / / /__\/ / / /\_______/ \/____\// / /\/___/ /      / / /   / / // / /    / / // / /  \/_// /____/\    / / /__\/ /  
 _    \ \ \   / / /   / / // / /_____/ /\ \    / / /_____/ / / /\ \ \           / / /   / / /      / / /   / / // / /    / / // / /      / /\____\/   / / /_____/   
/_/\__/ / /  / / /   / / // /_________/\ \ \  / / /\ \ \  / / /  \ \ \         / / /   / / /      / / /___/ / // / /    / / // / /      / / /______  / / /\ \ \     
\ \/___/ /  / / /   / / // / /_       __\ \_\/ / /  \ \ \/ / /    \ \ \       / / /   / / /      / / /____\/ // / /    / / //_/ /      / / /_______\/ / /  \ \ \    
 \_____\/   \/_/    \/_/ \_\___\     /____/_/\/_/    \_\/\/_/      \_\_\      \/_/    \/_/       \/_________/ \/_/     \/_/ \_\/       \/__________/\/_/    \_\/    
                                                                                                                                                                    

"